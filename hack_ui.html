<html>
<head>

<meta http-equiv="Content-Type" content="text/plain"; Charset=UTF-8">
<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script src="https://cdn.rawgit.com/ethereumjs/browser-builds/master/dist/ethereumjs-tx/ethereumjs-tx-1.3.3.js"></script>
<script src="https://unpkg.com/moralis-v1@latest/dist/moralis.js"></script>
</script> 

  

<STYLE TYPE="text/css">
.answers li {
list-style: upper-alpha;
}

label {
margin-left: 0.5em;
cursor: pointer;
}

#results {
background: #dddada;
color: 000000;
padding: 3px;
text-align: center;
width: 200px;
cursor: pointer;
border: 1px solid gray;
}

#results:hover {
background: #3d91b8;
color: #ffffff;
padding: 3px;
text-align: center;
width: 200px;
cursor: pointer;
border: 1px solid gray;
}





#closing {
display: none;
#font-style: italic;
}  

#answers{
    border:3px solid magenta;
    width:249px;
    float:left;
    font-size: 0.875em;
    padding:0 20px 0;
}

#answers[type="radio"]{
    float: left;
}

</style>
</head>

<body>

<h2 style="color:grey; font-family: Papyrus;"> H.I.T. Jobs </h2>
<p style="color:grey; font-family: Papyrus;">Blockchain-powered Human Intelligence Tasks - Earn Crypto!</p>




<p> Please carefully read the instructions: </p>
<p class='instruction' id="instructions"></p>	


						
<img id="image1" style="width=500px; height=600px"></img>						
<p class='question' id="question1"></p>	
<input type="text" id="answer1" style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>	

<img id="image2"></img>												
<p class='question' id="question2"></p>	
<input type="text" id="answer2" style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>

<img id="image3"</img>												
<p class='question' id="question3"></p>	
<input type="text" id="answer3" style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>							

<img id="image4"</img>										
<p class='question' id="question4"></p>	
<input type="text" id="answer4"  style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>							

<img id="image5"</img>					
<p class='question' id="question5"></p>	
<input type="text" id="answer5" style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>						

<img id="image6"</img>						
<p class='question' id="question6"></p>	
<input type="text" id="answer6" style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>							

<img id="image7"</img>
<p class='question' id="question7"></p>	
<input type="text" id="answer7" style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>						

<img id="image8"</img>
<p class='question' id="question8"></p>		
<input type="text" id="answer8" style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>						

<img id="image9"</img>
<p class='question' id="question9"></p>		
<input type="text" id="answer9" style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>						

<img id="image10"</img>
<p class='question' id="question10"></p>		
<input type="text" id="answer10" style="color:grey; font-family: helvetica narrow, sans-serif; font-size:x-large;"><label style="color:#DCDCDC; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:183; right:795;"></label>
					


		






	



	
<input type="button" value="SUBMIT" style="color:grey; font-family: helvetica narrow, sans-serif;font-size: large;" onClick="check_answers()"/>	











	





<script>
//https://bafybeicuofou2gs545lhbxdra6kjyradpb2fyocqgqfumz3fptvdf2pzgu.ipfs.nftstorage.link/
//<input type="button" value="send .25 matic" style="color:grey; font-family: helvetica narrow, sans-serif;font-size: large; position:absolute; top:15; right:15;" onClick="click_get()"/>	

const serverUrl = "https://jgvwtbhpz221.usemoralis.com:2053/server";
      const appId = "jWYZTSxykRh5PsXRtoXPWu3coM5QDQAWJCwvXR51";
      Moralis.start({ serverUrl, appId });
              

var metamask = (async function(){
  	
  await ethereum.enable();
  	
  
  //alert(balance)

})()

web3 = new Web3(web3.currentProvider);        

//var web3 = new Web3(new Web3.providers.HttpProvider(
    //"https://mainnet.infura.io/v3/69462286c61f42d2891a2ced35c91f8d"
//));


web3.eth.net.getNetworkType()
.then(console.log);

web3.eth.net.isListening()
   .then(() => console.log('web3 is connected'))
   .catch(e => console.log('Wow. Something went wrong'));


//NFT Pass Key//
//const contract = new web3.eth.Contract(contractAbi, contractAddress);
//const tokenBalance = await contract.methods.balanceOf(walletAddress).call();



const abi = [
	{
		"inputs": [],
		"name": "answer",
		"outputs": [
			{
				"internalType": "bytes32",
				"name": "",
				"type": "bytes32"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"name": "answers",
		"outputs": [
			{
				"internalType": "bytes32",
				"name": "",
				"type": "bytes32"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "correct",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "fee",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "filename",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_filename",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer0",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer1",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer2",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer3",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer4",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer5",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer6",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer7",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer8",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_answer9",
				"type": "string"
			}
		],
		"name": "setUptask",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_to",
				"type": "address"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer0",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer1",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer2",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer3",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer4",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer5",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer6",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer7",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer8",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_attemptAnswer9",
				"type": "string"
			}
		],
		"name": "verifyAnswer",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	}
]	


//var contract_address = web3.utils.toChecksumAddress("0x17868047286a8ec9ace12d359eb9c3eef54aeb62")


var my_nft =(async function(){
var contract_address = await web3.utils.toChecksumAddress("0x17868047286a8ec9ace12d359eb9c3eef54aeb62")

var contract_bal = await new web3.eth.Contract(abi, contract_address);
var file_name = await contract_bal.methods.filename().call();
alert(file_name)




const query = new Moralis.Query("Applications");
query.equalTo("name", file_name);
query.find().then(function ([application]) {
  const ipfs = application.get("resume").ipfs();
  const hash = application.get("resume").hash();
  loadJSON(ipfs, myData,'jsonp');
  console.log("IPFS url", ipfs);
  console.log("IPFS hash", hash);
});



// loadJSON method to open the JSON file.
function loadJSON(path, success, error) {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        success(JSON.parse(xhr.responseText));
      }
      else {
        error(xhr);
      }
    }
  };
  xhr.open('GET', path, true);
  xhr.send();
}

})()

function myData(Data)
{

  // Output only the details on the first post
  console.log(Data["questions"][0]["question"]);
  document.getElementById("image1").src = Data["questions"][1]["image_url"];
  document.getElementById("instructions").innerHTML = Data["questions"][0]["question"];
  document.getElementById("question1").innerHTML = Data["questions"][1]["question"];
  document.getElementById("question2").innerHTML = Data["questions"][2]["question"];
  document.getElementById("question3").innerHTML = Data["questions"][3]["question"];  
  document.getElementById("question4").innerHTML = Data["questions"][4]["question"];
  document.getElementById("question5").innerHTML = Data["questions"][5]["question"];
  document.getElementById("question6").innerHTML = Data["questions"][6]["question"];
  document.getElementById("question7").innerHTML = Data["questions"][7]["question"];  
  document.getElementById("question8").innerHTML = Data["questions"][8]["question"];
  document.getElementById("question9").innerHTML = Data["questions"][9]["question"];  
  document.getElementById("question10").innerHTML = Data["questions"][10]["question"];
  // output the details of first three posts
  //console.log("First three posts");
  //for(var i=0; i<3; i=i+1)
  //{
    //console.log(Data[i]);
  //} 
  // output the id field of first five elements. 
  //console.log("First five ID");
  //for(var i=0; i<5; i=i+1)
  //{
    //console.log(Data[i].id);
  //}
}	
		
		
		
		
		
		
function getAccounts(){
	const res = web3.eth.getAccounts(); 
	return res;
	
}

function click_get(){
var acct = (async function(){
  	
  //var result = await getAccounts()
	await window.ethereum.enable();
	//var pwd = document.getElementById("password").value;
		const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const account = accounts[0];
        var _data = new web3.eth.Contract(abi, contract_address).methods.set_password(account).encodeABI();
        
	const result = await web3.eth.getTransactionCount(account)
	_nonce = result
        console.log(account)
	await web3.eth.sendTransaction({'gas': web3.utils.toHex(100000),'gasPrice': web3.utils.toHex(web3.utils.toWei('100', 'gwei')), 'from': account, 'to': contract_address, 'value': web3.utils.toHex(200001), 'nonce': web3.utils.toHex(_nonce),'data': _data})
         //window.ethereum.on('accountsChanged', function (accounts) {
            // Time to reload your interface with accounts[0]!
            //console.log(accounts[0])
           	
  //console.log('Woo done!', result[0])
  //balance = result
  //alert(balance)

})()
}


function mint_nft_pass(){
var acct = (async function(){
  	
  //var result = await getAccounts()
	await window.ethereum.enable();
	//var pwd = document.getElementById("password").value;
		const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const account = accounts[0];
        var _data = new web3.eth.Contract(abi, contract_address).methods.mint("https://bafybeicuofou2gs545lhbxdra6kjyradpb2fyocqgqfumz3fptvdf2pzgu.ipfs.nftstorage.link/LCBPASS1.png").encodeABI();
        
	const result = await web3.eth.getTransactionCount(account)
	_nonce = result
        console.log(account)
	await web3.eth.sendTransaction({'gas': web3.utils.toHex(100000),'gasPrice': web3.utils.toHex(web3.utils.toWei('100', 'gwei')), 'from': account, 'to': contract_address, 'value': web3.utils.toHex(200001), 'nonce': web3.utils.toHex(_nonce),'data': _data})
         //window.ethereum.on('accountsChanged', function (accounts) {
            // Time to reload your interface with accounts[0]!
            //console.log(accounts[0])
           	
  //console.log('Woo done!', result[0])
  //balance = result
  //alert(balance)

})()
}



const contract_address = web3.utils.toChecksumAddress("0x17868047286a8ec9ace12d359eb9c3eef54aeb62")

const contract_bal = new web3.eth.Contract(abi, contract_address);

const wallet_address = "0xBC7f9EbC7dBCc236873f37005cfD959523faB727"

//client_account = accounts[0]; // assuming master client addr

getAccounts(function(result){
	console.log(result[0]);
	});

function contribute_to_the_project() {
  const amount = "0.00001"; 
  const amountToSend = web3.utils.toWei(amount, "ether"); // Convert to wei value
  web3.eth.sendTransaction({ 
    from: client_account,
    to: contract_address, 
    value: amountToSend 
  }).then( function(tx) { ;
  console.log("Transaction: ", tx); 
  });
}

// $(document).ready(function(){
function getSupply(acct){
		//var acct = (async function(){
		//need to map address to nft id
		const contract = web3.utils.toChecksumAddress("0x17868047286a8ec9ace12d359eb9c3eef54aeb62")
		//const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        //const account = accounts[0];
            const supply = new web3.eth.Contract(abi, contract).methods.balanceOf(acct, 0).call();
		//var supply = await contract_bal.methods.balanceOf(account, nft_id).call();
		
		//console.log("supply: " + supply);
		return supply;
		//})()
		}
        //});
		
function isApproved(act){


        //localStorage.setItem("mySharedData", document.getElementById("password").value);
    
	
	//var pwdx = localStorage.getItem("mySharedData");

	const contract_address = web3.utils.toChecksumAddress("0x17868047286a8ec9ace12d359eb9c3eef54aeb62")
  	
	var acct = act; 
	const contract_bal = new web3.eth.Contract(abi, contract_address);
	const bal = contract_bal.methods.isApproved(acct).call();
	
	return bal
	}

function check_approval(){
var approve = (async function(){

		const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const account = accounts[0];
		console.log(account)
const contract = new web3.eth.Contract(abi, "0x17868047286a8ec9ace12d359eb9c3eef54aeb62");
//const tokenBalance = await contract.methods.balanceOf(account).call();

if (i > 1){
	show1()
	}else{
  //var result = await isApproved(account)
  var result = await getSupply(account)
  	
  console.log('Woo done!', result)
  balance = result
  
	//if(balance == true){
	if(balance > 0){
  	show1();
	}else{
	alert("send 1 matic for full & repeat access")
	}
}
//alert(balance)

})()
}

function getvalue(n, q){
//q = $('input[name=drone]:checked').val();	
	//alert(bal)
	
var val = (async function(){
  const contract_address = await web3.utils.toChecksumAddress("0x17868047286a8ec9ace12d359eb9c3eef54aeb62")
  const wallet_address = "0xBC7f9EbC7dBCc236873f37005cfD959523faB727"
  const contract_bal = await new web3.eth.Contract(abi, contract_address);
  const bal = await contract_bal.methods.getHashmap(wallet_address, n).call();
  //alert(bal);
  //var result = await getvalue()
  //console.log('Woo done!', result)
  if (q == bal){
	count += 1;
  	answers1.push("Correct: " + " " + bal);
	
  }else{
	answers1.push("incorrect: " + " " + bal);
  }
	

})()
//return val
	}





function sendDeposit() {

var _data = new web3.eth.Contract(abi, contract_address).methods.set_password(pwd).encodeABI();
contract_bal.utils.deposit({from: web3.eth.accounts[0], to: contract_address, gas: web3.utils.toHex(web3.utils.toWei('250', 'gwei')), value: web3.utils.toHex(2000001), data: _data}, function(err, res){ })   


        }

function getvalue1(n){
//q = $('input[name=drone]:checked').val();	
	//alert(bal)
	
var val = (async function(){
  const contract_address = await web3.utils.toChecksumAddress("0x17868047286a8ec9ace12d359eb9c3eef54aeb62")
  const wallet_address = "0xBC7f9EbC7dBCc236873f37005cfD959523faB727"
  const contract_bal = await new web3.eth.Contract(abi, contract_address);
  const bal = await contract_bal.methods.getHashmap1(wallet_address, n).call();
  //alert(bal)
  //var result = await getvalue()
  //console.log('Woo done!', result)
  answers2.push(" " + bal);
if (i > 80){
			containsX();
			}
})()
//return val
	}



function send_ether(){
var nonce = (async function(){
  	const contract_address = await web3.utils.toChecksumAddress("0x17868047286a8ec9ace12d359eb9c3eef54aeb62")
  
	const wallet_address = "0xBC7f9EbC7dBCc236873f37005cfD959523faB727"
	
	var result = await web3.eth.getTransactionCount(wallet_address)
  
	console.log('Woo done!', result)
  
	_nonce = result
  
	//alert(_nonce)
	
  
	const txn_dict = {'gas': web3.utils.toHex(250000),'gasPrice': web3.utils.toHex(web3.utils.toWei('250', 'gwei')), 'to': contract_address, 'from': wallet_address, 'value': web3.utils.toHex(2000001),'nonce': _nonce}
  
	
  
	const tx = await new ethereumjs.Tx(txn_dict, {chain:'ropsten'})

	//tx.sign(private_key)

	const serializedTx = await tx.serialize();

	const raw = '0x' + serializedTx.toString('hex')

	const transaction = await web3.eth.sendSignedTransaction(raw, (err, tx) => {
	web3.eth.transactionPollingTimeout = 2000;
	console.log(tx)
	})


})()
}

function check_answers(){

	//var nft = add1x[0];
	//var address = add2x
	//var nft_id = tokenID[0];
	//var num = n
	
	//to_approve(nft, nft_id)
var acct = (async function(){
  	
  //var result = await getAccounts()
	await window.ethereum.enable();
	
		var accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        var account = accounts[0];
		//console.log("account " + account);
		//console.log("nft address " + nft);
		//console.log("nft id " + nft_id);
		//const contract_address1 = web3.utils.toChecksumAddress(nft);
		//var filename = document.getElementById("file_name").value;
		var answer1 = document.getElementById("answer1").value;
		var answer2 = document.getElementById("answer2").value;
		var answer3 = document.getElementById("answer3").value;
		var answer4 = document.getElementById("answer4").value;
		var answer5 = document.getElementById("answer5").value;
		var answer6 = document.getElementById("answer6").value;
		var answer7 = document.getElementById("answer7").value;
		var answer8 = document.getElementById("answer8").value;
		var answer9 = document.getElementById("answer9").value;
		var answer10 = document.getElementById("answer10").value;
		//var contract_bal = await new web3.eth.Contract(abi, nft).methods.balanceOf(account, nft_id).call();
		//var supply = await new web3.eth.Contract(abi, contract_address1).methods.balanceOf(account, nft_id).call();
		//var supply = await contract_bal.methods.balanceOf(account, nft_id).call();
		
		//console.log(supply);
        var _data = new web3.eth.Contract(abi, contract_address).methods.verifyAnswer(account, answer1, answer2, answer3, answer4, answer5, answer6, answer7, answer8, answer9, answer10).encodeABI();
        
	var result = await web3.eth.getTransactionCount(account)
	_nonce = result
        //console.log(account)
		
	await web3.eth.sendTransaction({'gas': web3.utils.toHex(500000),'gasPrice': web3.utils.toHex(web3.utils.toWei('100', 'gwei')), 'from': account, 'to': contract_address, 'nonce': web3.utils.toHex(_nonce),'data': _data})
         

})()
}

function set_password(){
	
q = $('input[name=drone]:checked').val();
var nonce = (async function(){
  	const contract_address = await web3.utils.toChecksumAddress("0x17868047286a8ec9ace12d359eb9c3eef54aeb62")
  	const wallet_address = "0xBC7f9EbC7dBCc236873f37005cfD959523faB727"
	var pwd = document.getElementById("password").value;	
	
	
	//alert(data)
	
	var result = await web3.eth.getTransactionCount(wallet_address)
  
	console.log('Woo done!', result)
  
	_nonce = result
  
	//alert(_nonce)
	//var data = await new web3.eth.Contract(abi, contract_address).methods.set_value(web3.utils.toHex(1)).call();
//var data = (async function(){	
	
	var _data = new web3.eth.Contract(abi, contract_address).methods.set_password(pwd).encodeABI();
  	//alert(_data)
	//})()
	const txn_dict = {'gas': web3.utils.toHex(160000),'gasPrice': web3.utils.toHex(web3.utils.toWei('160', 'gwei')), 'from': wallet_address, 'to': contract_address, 'value': web3.utils.toHex(2000001), 'nonce': web3.utils.toHex(_nonce),'data': _data}
  	//alert(txn_dict['nonce'])
	
  
	const tx = await new ethereumjs.Tx(txn_dict, {chain:'ropsten'})

	//tx.sign(private_key)

	const serializedTx = await tx.serialize();

	const raw = '0x' + serializedTx.toString('hex')

	const transaction = await web3.eth.sendSignedTransaction(raw, (err, tx) => {
	web3.eth.transactionPollingTimeout = 2000;
	console.log(tx)
	})


})()
}
    
    
          
    </script>
	
</body>
</html>